<div [@routerTransition]>
  <div class="content d-flex flex-column flex-column-fluid">
    <sub-header [breadcrumbs]="breadcrumbs" [title]="l('CreateNewRequests')">
      <div *ngIf="isEnabled('App.DedicatedTruckFeature')" role="actions">
        <button (click)="goToDedicatedWizard()" class="btn btn-primary blue"><i class="fa fa-plus"></i> {{ l('NewDedicatedRequest') }}</button>
      </div>
    </sub-header>

    <div class="container">
      <div class="card card-custom gutter-b">
        <ng-container *ngIf="saving">
          <div class="progress progress-modal">
            <div
              class="progress-bar progress-bar-striped progress-bar-animated bg-primary"
              role="progressbar"
              style="width: 100%"
              aria-valuenow="100"
              aria-valuemin="0"
              aria-valuemax="100"
            ></div>
          </div>
        </ng-container>
        <div class="card-header">
          <div class="card-title">
            <h3 class="card-label">
              <ng-container>{{ l('NewShippingRequest') }} </ng-container>
            </h3>
          </div>
          <div class="card-toolbar">
            <a type="button" class="btn btn-light" routerLink="/app/main/shippingRequests/shippingRequests">
              <i class="fa fa-arrow-left"></i> {{ l('Back') }}</a
            >
            <button class="btn btn-secondary ml-2" (click)="resetWizard()" [disabled]="!activeShippingRequestId">
              <i class="fa fa-redo"></i>{{ l('Reset') }}
            </button>
          </div>
        </div>
        <div class="card-body">
          <!--begin: Wizard -->
          <div #wizard class="wizard wizard-1" id="kt_wizard_v1" data-wizard-state="step-first" data-wizard-clickable="true" [busyIf]="loading">
            <!--begin: Form Wizard Nav -->
            <div class="wizard-nav border-bottom">
              <div class="wizard-steps p-8 p-lg-10">
                <a class="wizard-step" href="javascript:;" data-wizard-type="step" data-wizard-state="current">
                  <div class="wizard-label">
                    <i class="wizard-icon flaticon-list text-danger"></i>
                    <h3 class="wizard-title">{{ l('BasicDetails') }}</h3>
                  </div>
                </a>
                <a class="wizard-step" href="javascript:;" data-wizard-type="step">
                  <div class="wizard-label">
                    <i class="wizard-icon flaticon-bus-stop text-danger"></i>
                    <h3 class="wizard-title">{{ l('RouteDetails') }}</h3>
                  </div>
                </a>
                <a class="wizard-step" href="javascript:;" data-wizard-type="step">
                  <div class="wizard-label">
                    <i class="wizard-icon flaticon-open-box text-danger"></i>
                    <h3 class="wizard-title">{{ l('GoodDetails') }}</h3>
                  </div>
                </a>
                <a class="wizard-step" href="javascript:;" data-wizard-type="step">
                  <div class="wizard-label">
                    <i class="wizard-icon flaticon-app text-danger"></i>
                    <h3 class="wizard-title">{{ l('Vas') }}</h3>
                  </div>
                </a>
                <a class="wizard-step" href="javascript:;" data-wizard-type="step">
                  <div class="wizard-label">
                    <i class="wizard-icon flaticon-globe text-danger"></i>
                    <h3 class="wizard-title">{{ l('ReviewAndSubmit') }}</h3>
                  </div>
                </a>
              </div>
            </div>
            <!--end: Form Wizard Nav -->
            <div class="row justify-content-center my-10 px-8 my-lg-15 px-lg-10">
              <div class="col-xl-12 col-xxl-8">
                <!--begin: Form Wizard Form-->
                <div class="form" id="kt_form">
                  <!--begin: Form Wizard Step 1-->
                  <div class="pb-5" [formGroup]="step1Form" data-wizard-type="step-content" data-wizard-state="current">
                    <div *ngIf="this.feature.isEnabled('App.TachyonDealer')" class="form-group">
                      <label>{{ l('Shipper') }} <span class="required-fileds">*</span></label>
                      <div
                        [ngClass]="{
                          'spinner spinner-success spinner-right mr-1 ml-1': !AllShippers
                        }"
                      >
                        <select
                          class="form-control"
                          name="Shipper"
                          formControlName="Shipper"
                          [(ngModel)]="step1Dto.shipperId"
                          (change)="shippingRequestType = 'tachyondeal'"
                          required
                        >
                          <option [value]="undefined" disabled>{{ l('SelectShipper') }}</option>
                          <option *ngFor="let item of AllShippers" value="{{ item.id }}">{{ item.displayName }}</option>
                        </select>
                      </div>
                      <span class="form-text text-muted">{{ l('SelectShipper') }} {{ step1Dto.shipperId }}</span>
                    </div>
                    <div *ngIf="this.feature.isEnabled('App.ShipperClients') && this.feature.isEnabled('App.CarrierClients')">
                      <h2 class="font-size-lg text-dark font-weight-bold mb-6">{{ l('Broker:') }}</h2>

                      <div class="form-group row">
                        <label class="col-3 col-form-label">{{ l('IsInternalBrokerRequest') }} </label>
                        <div class="col-3">
                          <span class="switch switch-icon">
                            <label>
                              <input
                                (change)="removeCarrierInputFromForm1()"
                                type="checkbox"
                                [(ngModel)]="step1Dto.isInternalBrokerRequest"
                                formControlName="IsInternalBrokerRequest"
                              />
                              <span></span>
                            </label>
                          </span>
                        </div>
                      </div>
                    </div>

                    <div *ngIf="this.feature.isEnabled('App.ShipperClients')" class="form-group">
                      <label>{{ l('ActorShipper') }}</label>
                      <div
                        [ngClass]="{
                          'spinner spinner-success spinner-right mr-1 ml-1': !AllActorsShippers
                        }"
                      >
                        <dx-select-box
                          id="ActorShipper"
                          name="ActorShipper"
                          formControlName="ActorShipper"
                          [(value)]="step1Dto.shipperActorId"
                          [dataSource]="AllActorsShippers"
                          [searchEnabled]="true"
                          displayExpr="displayName"
                          valueExpr="id"
                          [required]="true"
                          placeholder="{{ l('SelectActor') }}"
                        >
                        </dx-select-box>
                      </div>
                      <span class="form-text text-muted">{{ l('SelectShipperActor') }}</span>
                    </div>

                    <div [hidden]="!this.feature.isEnabled('App.CarrierClients') || !step1Dto.isInternalBrokerRequest" class="form-group">
                      <label>{{ l('ActorCarrier') }}</label>
                      <div
                        [ngClass]="{
                          'spinner spinner-success spinner-right mr-1 ml-1': !AllActorsCarriers
                        }"
                      >
                        <dx-select-box
                          id="ActorCarrier"
                          name="ActorCarrier"
                          formControlName="ActorCarrier"
                          [(value)]="step1Dto.carrierActorId"
                          [dataSource]="AllActorsCarriers"
                          [searchEnabled]="true"
                          displayExpr="displayName"
                          valueExpr="id"
                          [required]="step1Dto.isInternalBrokerRequest ? true : false"
                          placeholder="{{ l('SelectActor') }}"
                        >
                        </dx-select-box>
                      </div>
                      <span class="form-text text-muted">{{ l('SelectCarrierActor') }}</span>
                    </div>

                    <div class="separator separator-dashed my-5"></div>

                    <div *ngIf="!isCarrierSass" [hidden]="step1Dto.isInternalBrokerRequest" class="form-group">
                      <label>{{ l('ShippingRequestType') }} <span class="required-fileds">*</span></label>
                      <select
                        class="form-control"
                        name="shippingRequestType"
                        formControlName="shippingRequestType"
                        [(ngModel)]="shippingRequestType"
                        (change)="validateCarrierForDirectRequest()"
                        [class.is-valid]="
                          step1Form.get('shippingRequestType').valid &&
                          (step1Form.get('shippingRequestType').dirty || step1Form.get('shippingRequestType').touched)
                        "
                        [class.is-invalid]="
                          step1Form.get('shippingRequestType').invalid &&
                          (step1Form.get('shippingRequestType').dirty || step1Form.get('shippingRequestType').touched)
                        "
                        [required]="!step1Dto.isInternalBrokerRequest"
                        readonly="readonly"
                        [attr.disabled]="step1Dto.shipperId > 0 ? true : null"
                      >
                        <option value="undefined" selected disabled>{{ l('Select') }}</option>
                        <option *ngIf="feature.isEnabled('App.MarketPlace')" [value]="'bidding'">{{ l('Marketplace') }}</option>
                        <option [value]="'tachyondeal'">{{ l('TachyonManageService') }}</option>
                        <option *ngIf="this.feature.isEnabled('App.SendDirectRequest')" value="directrequest">
                          {{ l('DirectRequest') }}
                        </option>
                      </select>
                      <span class="form-text text-muted">{{ l('PickaShippingRequestType') }}</span>
                    </div>
                    <div class="form-group" [hidden]="shippingRequestType !== 'directrequest' || isCarrierSass || step1Dto.isInternalBrokerRequest">
                      <label>{{ l('SelectCarriers') }} <span *ngIf="shippingRequestType === 'directrequest'" class="required-fileds">*</span></label>
                      <div
                        [ngClass]="{
                          'spinner spinner-success spinner-right mr-1 ml-1': !allCarriers
                        }"
                      >
                        <p-dropdown
                          name="allCarriers"
                          [options]="allCarriers"
                          class="form-control"
                          [(ngModel)]="step1Dto.carrierTenantIdForDirectRequest"
                          placeholder="{{ l('SelectaCarrier') }}"
                          optionLabel="displayName"
                          optionValue="id"
                          [showClear]="true"
                          [styleClass]="'myCarrierInput'"
                          formControlName="carrier"
                          [dataKey]="'id'"
                          [required]="shippingRequestType === 'directrequest'"
                          [class.is-valid]="step1Form.get('carrier').valid && (step1Form.get('carrier').dirty || step1Form.get('carrier').touched)"
                          [class.is-invalid]="
                            step1Form.get('carrier').invalid && (step1Form.get('carrier').dirty || step1Form.get('carrier').touched)
                          "
                        >
                          <ng-template let-carrier pTemplate="item">
                            <div class="country-item">
                              <span style="float: left; margin-right: 10px; width: 45%">{{ carrier.displayName }}</span>
                              <span style="float: left; width: 50%">
                                <ng-template #t let-fill="fill">
                                  <span class="star p-0" [class.full]="fill === 100">
                                    <span class="half" [style.width.%]="fill">&#9733;</span>&#9733;</span
                                  >
                                </ng-template>
                                <ngb-rating [(rate)]="carrier.rate" [starTemplate]="t" [readonly]="true" [max]="5"></ngb-rating>
                              </span>
                            </div>
                          </ng-template>
                        </p-dropdown>
                        <!--                        <select-->
                        <!--                          class="form-control dropdown"-->
                        <!--                          name="carrier"-->
                        <!--                          formControlName="carrier"-->
                        <!--                          [(ngModel)]="step1Dto.carrierTenantIdForDirectRequest"-->
                        <!--                          [required]="shippingRequestType == 'directrequest'"-->
                        <!--                          [class.is-valid]="step1Form.get('carrier').valid && (step1Form.get('carrier').dirty || step1Form.get('carrier').touched)"-->
                        <!--                          [class.is-invalid]="-->
                        <!--                            step1Form.get('carrier').invalid && (step1Form.get('carrier').dirty || step1Form.get('carrier').touched)-->
                        <!--                          "-->
                        <!--                        >-->
                        <!--                          <option *ngFor="let item of allCarriers" value="{{ item.id }}">{{ item.displayName }}</option>-->
                        <!--                        </select>-->
                      </div>
                      <span class="form-text text-muted">{{ l('SelectACarrier') }}</span>
                    </div>

                    <div class="row pb-5" *ngIf="shippingRequestType == 'bidding'" [@grow]>
                      <!--                        bidding gonna be here -->
                      <div class="col-lg-6">
                        <div class="form-group">
                          <hijri-gregorian-datepicker-test
                            [parentForm]="parentForm"
                            [label]="l('BiddingStartDate')"
                            class="m-input"
                            [disabled]="shippingRequestType == 'bidding' ? null : true"
                            [readonly]="true"
                            [minHijri]="todayHijri"
                            [minGreg]="todayGregorian"
                            [selectedDate]="startBiddate"
                            (selectedDateChange)="validateBiddingDates($event, 'biddingStartDate')"
                          >
                          </hijri-gregorian-datepicker-test>
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-group">
                          <hijri-gregorian-datepicker-test
                            [parentForm]="parentForm"
                            [label]="l('BiddingEndDate')"
                            class="m-input"
                            [disabled]="shippingRequestType == 'bidding' ? null : true"
                            [readonly]="true"
                            [minHijri]="minHijriEndDate"
                            [minGreg]="minGrogEndDate"
                            [selectedDate]="endBiddate"
                            (selectedDateChange)="validateBiddingDates($event, 'biddingEndDate')"
                          >
                          </hijri-gregorian-datepicker-test>
                        </div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label>{{ l('ShippingType') }} <span class="required-fileds">*</span></label>
                      <div
                        [ngClass]="{
                          'spinner spinner-success spinner-right mr-1 ml-1': !allShippingTypes
                        }"
                      >
                        <select
                          class="form-control"
                          name="shippingType"
                          formControlName="shippingType"
                          [(ngModel)]="step1Dto.shippingTypeId"
                          (change)="resetStep2Inputs(); fillAllRoundTrips()"
                          [class.is-valid]="
                            step1Form.get('shippingType').valid && (step1Form.get('shippingType').dirty || step1Form.get('shippingType').touched)
                          "
                          [class.is-invalid]="
                            step1Form.get('shippingType').invalid && (step1Form.get('shippingType').dirty || step1Form.get('shippingType').touched)
                          "
                          required
                        >
                          <!--                          <option [ngValue]="null">{{ l('SelectAshippingType') }}</option>-->
                          <option *ngFor="let item of allShippingTypes" value="{{ item.id }}">{{ item.displayName }}</option>
                        </select>
                      </div>
                      <span class="form-text text-muted">{{ l('SelectAShippingType') }}</span>
                    </div>
                    <div
                      class="form-group"
                      *ngIf="
                        step1Dto.shippingTypeId == ShippingTypeEnum.ImportPortMovements ||
                        step1Dto.shippingTypeId == ShippingTypeEnum.ExportPortMovements
                      "
                    >
                      <label>{{ l('RoundTrip') }} <span class="required-fileds">*</span></label>
                      <div
                        [ngClass]="{
                          'spinner spinner-success spinner-right mr-1 ml-1': !allShippingTypes
                        }"
                      >
                        <select
                          class="form-control"
                          name="roundTripType"
                          formControlName="roundTripType"
                          [(ngModel)]="step1Dto.roundTripType"
                          [class.is-valid]="
                            step1Form.get('roundTripType').valid && (step1Form.get('roundTripType').dirty || step1Form.get('roundTripType').touched)
                          "
                          [class.is-invalid]="
                            step1Form.get('roundTripType').invalid && (step1Form.get('roundTripType').dirty || step1Form.get('roundTripType').touched)
                          "
                          required
                          (ngModelChange)="resetStep2Inputs(); prepareStep2Inputs()"
                        >
                          <option disabled [ngValue]="null">{{ l('SelectARoundTripType') }}</option>
                          <option *ngFor="let item of allRoundTripTypes" value="{{ item.id }}">{{ item.displayName }}</option>
                        </select>
                      </div>
                      <span class="form-text text-muted">{{ l('SelectARoundTripType') }}</span>
                    </div>

                    <div class="row">
                      <div class="col-lg-6">
                        <div class="form-group">
                          <hijri-gregorian-datepicker-test
                            [parentForm]="parentForm"
                            [label]="l('TripsStartDate')"
                            class="m-input"
                            [readonly]="true"
                            [minHijri]="!isTachyonDealer ? todayHijri : ''"
                            [minGreg]="!isTachyonDealer ? todayGregorian : ''"
                            [selectedDate]="startTripdate"
                            (selectedDateChange)="validateTripsDates($event, 'tripsStartDate')"
                          >
                          </hijri-gregorian-datepicker-test>
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-group">
                          <hijri-gregorian-datepicker-test
                            [parentForm]="parentForm"
                            [label]="l('TripsEndDate')"
                            class="m-input"
                            [readonly]="true"
                            [minHijri]="minHijriTripdate"
                            [minGreg]="minGrogTripdate"
                            [selectedDate]="endTripdate"
                            (selectedDateChange)="validateTripsDates($event, 'tripsEndDate')"
                          >
                          </hijri-gregorian-datepicker-test>
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-group">
                          <label>{{ l('ShipperReference') }} </label>
                          <div class="input-group date">
                            <input
                              formControlName="ShipperReference"
                              class="form-control"
                              type="text"
                              name="ShipperReference"
                              [(ngModel)]="step1Dto.shipperReference"
                            />
                          </div>
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-group">
                          <label>{{ l('ShipperInvoiceNumber') }}</label>
                          <div class="input-group date">
                            <input
                              formControlName="ShipperInvoiceNumber"
                              class="form-control"
                              type="text"
                              name="ShipperInvoiceNumber"
                              [(ngModel)]="step1Dto.shipperInvoiceNo"
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--end: Form Wizard Step 1-->
                  <!-- begin: Form Wizard Step 2-->
                  <div class="pb-5" [formGroup]="step2Form" data-wizard-type="step-content">
                    <div class="row">
                      <!-- Start of Select Source -->

                      <!-- Route type -->
                      <div
                        class="col-lg-6"
                        *ngIf="
                          step1Dto.shippingTypeId != ShippingTypeEnum.ImportPortMovements &&
                          step1Dto.shippingTypeId != ShippingTypeEnum.ExportPortMovements
                        "
                      >
                        <label> {{ l('RouteType') }} <span class="required-fileds">*</span></label>
                        <div [ngClass]="{ 'spinner spinner-success spinner-right mr-1 ml-1': !allRoutTypes }">
                          <select
                            class="form-control"
                            name="routeType"
                            #routeType
                            formControlName="routeType"
                            [attr.disabled]="allRoutTypes ? null : true"
                            [(ngModel)]="step2Dto.routeTypeId"
                            [class.is-valid]="
                              step2Form.get('routeType').valid && (step2Form.get('routeType').dirty || step2Form.get('routeType').touched)
                            "
                            [class.is-invalid]="
                              step2Form.get('routeType').invalid && (step2Form.get('routeType').dirty || step2Form.get('routeType').touched)
                            "
                            (change)="routeTypeChanged()"
                            required
                          >
                            <option [ngValue]="null" disabled selected>{{ l('SelectRouteType') }}</option>
                            <option [value]="code.key" *ngFor="let code of allRoutTypes">
                              {{ l(code.value) }}
                            </option>
                            <!--<option *ngFor="let item of allRoutTypes" value="{{ item.id }}">{{ item.displayName }}</option>-->
                          </select>
                        </div>
                        <span class="form-text text-muted">{{ l('PickaRouteType') }}</span>
                      </div>

                      <!--    Countries    -->
                      <div class="col-lg-6">
                        <div class="form-group">
                          <label
                            >{{
                              step1Dto.shippingTypeId != ShippingTypeEnum.ImportPortMovements &&
                              step1Dto.shippingTypeId != ShippingTypeEnum.ExportPortMovements
                                ? l('OriginCountry')
                                : l('Country')
                            }}
                            <span class="required-fileds">*</span>
                          </label>
                          <div [ngClass]="{ 'spinner spinner-success spinner-right mr-1 ml-1': !allCountries }">
                            <select
                              class="form-control"
                              name="originCountry"
                              formControlName="originCountry"
                              [(ngModel)]="originCountry"
                              [class.is-valid]="
                                step2Form.get('originCountry').valid &&
                                (step2Form.get('originCountry').dirty || step2Form.get('originCountry').touched)
                              "
                              [class.is-invalid]="
                                step2Form.get('originCountry').invalid &&
                                (step2Form.get('originCountry').dirty || step2Form.get('originCountry').touched)
                              "
                              (ngModelChange)="validateShippingRequestType()"
                              (change)="loadCitiesByCountryId(originCountry, 'source')"
                              required
                            >
                              <option value="undefined" selected disabled>{{ l('SelectanOriginCountry') }}</option>
                              <option *ngFor="let item of allCountries" value="{{ item.id }}">{{ item.translatedDisplayName }}</option>
                            </select>
                          </div>

                          <span class="form-text text-muted">{{ l('SelectaCountry') }}</span>
                        </div>
                      </div>
                      <div class="col-lg-6" [hidden]="step1Dto.shippingTypeId != ShippingTypeEnum.CrossBorderMovements">
                        <div class="form-group">
                          <label> {{ l('DestinationCountry') }}<span class="required-fileds">*</span></label>
                          <div [ngClass]="{ 'spinner spinner-success spinner-right mr-1 ml-1': !allCountries }">
                            <select
                              class="form-control"
                              name="destinationCountry"
                              formControlName="destinationCountry"
                              [(ngModel)]="destinationCountry"
                              [class.is-valid]="
                                step2Form.get('destinationCountry').valid &&
                                (step2Form.get('destinationCountry').dirty || step2Form.get('destinationCountry').touched)
                              "
                              [class.is-invalid]="
                                step2Form.get('destinationCountry').invalid &&
                                (step2Form.get('destinationCountry').dirty || step2Form.get('destinationCountry').touched)
                              "
                              [attr.disabled]="step1Dto.shippingTypeId == 2 || step1Dto.shippingTypeId == 1 ? true : null"
                              (ngModelChange)="validateShippingRequestType()"
                              (change)="loadCitiesByCountryId(destinationCountry, 'destination')"
                              required
                            >
                              <option value="undefined" selected disabled>{{ l('SelectanDestinationCountry') }}</option>
                              <option *ngFor="let item of allCountries" value="{{ item.id }}">{{ item.displayName }}</option>
                            </select>
                            <div class="invalid-feedback">{{ l('SourceAndDestinationCantBeTheSame') }}</div>
                          </div>
                          <span class="form-text text-muted">{{ l('SelectaCountry') }}</span>
                        </div>
                      </div>

                      <!--    Cities        -->
                      <div class="col-lg-6">
                        <div
                          class="form-group"
                          *ngIf="
                            step1Dto.shippingTypeId != ShippingTypeEnum.ImportPortMovements &&
                            step1Dto.shippingTypeId != ShippingTypeEnum.ExportPortMovements
                          "
                        >
                          <label>{{ l('OriginCity') }} <span class="required-fileds">*</span> </label>
                          <div [ngClass]="{ 'spinner spinner-success spinner-right mr-1 ml-1': citiesLoading }">
                            <select
                              class="form-control"
                              name="originCity"
                              formControlName="originCity"
                              [(ngModel)]="step2Dto.originCityId"
                              [attr.disabled]="!sourceCities ? true : null"
                              [class.is-valid]="
                                step2Form.get('originCity').valid && (step2Form.get('originCity').dirty || step2Form.get('originCity').touched)
                              "
                              [class.is-invalid]="
                                step2Form.get('originCity').invalid && (step2Form.get('originCity').dirty || step2Form.get('originCity').touched)
                              "
                              (ngModelChange)="validateShippingRequestType()"
                              required
                            >
                              <option [ngValue]="null" disabled selected>{{ l('SelectanOriginCity') }}</option>
                              <option *ngFor="let originCity of sourceCities" [ngValue]="Number(originCity.id)">{{ originCity.displayName }}</option>
                            </select>
                          </div>

                          <span class="form-text text-muted">{{ l('SelectaCity') }}</span>
                        </div>
                        <div
                          class="form-group"
                          *ngIf="
                            step1Dto.shippingTypeId == ShippingTypeEnum.ImportPortMovements ||
                            step1Dto.shippingTypeId == ShippingTypeEnum.ExportPortMovements
                          "
                        >
                          <label>{{ l('Origin') }} <span class="required-fileds">*</span> </label>
                          <div [ngClass]="{ 'spinner spinner-success spinner-right mr-1 ml-1': citiesLoading }">
                            <select
                              class="form-control"
                              name="originFacility"
                              formControlName="originFacility"
                              [(ngModel)]="step2Dto.originFacilityId"
                              [attr.disabled]="!allOriginPorts ? true : null"
                              [class.is-valid]="
                                step2Form.get('originFacility').valid &&
                                (step2Form.get('originFacility').dirty || step2Form.get('originFacility').touched)
                              "
                              [class.is-invalid]="
                                step2Form.get('originFacility').invalid &&
                                (step2Form.get('originFacility').dirty || step2Form.get('originFacility').touched)
                              "
                              (ngModelChange)="
                                validateShippingRequestType(); getCityIdFromSelectedPort($event); removeValidationForImportPortRequestOnStep2Form()
                              "
                              required
                              *ngIf="step1Dto.shippingTypeId == ShippingTypeEnum.ImportPortMovements"
                            >
                              <option [ngValue]="null" disabled selected>{{ l('SelectanOrigin') }}</option>
                              <option *ngFor="let originPort of allOriginPorts" [ngValue]="Number(originPort.id)">
                                {{ originPort.displayName }}
                              </option>
                            </select>
                            <select
                              class="form-control"
                              name="originCity"
                              formControlName="originCity"
                              [(ngModel)]="step2Dto.originCityId"
                              [attr.disabled]="!sourceCities ? true : null"
                              [class.is-valid]="
                                step2Form.get('originCity').valid && (step2Form.get('originCity').dirty || step2Form.get('originCity').touched)
                              "
                              [class.is-invalid]="
                                step2Form.get('originCity').invalid && (step2Form.get('originCity').dirty || step2Form.get('originCity').touched)
                              "
                              (ngModelChange)="validateShippingRequestType(); removeValidationForExportPortRequestOnStep2Form()"
                              required
                              *ngIf="step1Dto.shippingTypeId == ShippingTypeEnum.ExportPortMovements"
                            >
                              <option [ngValue]="null" disabled selected>{{ l('SelectanOriginCity') }}</option>
                              <option *ngFor="let originCity of sourceCities" [ngValue]="Number(originCity.id)">{{ originCity.displayName }}</option>
                            </select>
                          </div>

                          <span class="form-text text-muted">{{
                            step1Dto.shippingTypeId == ShippingTypeEnum.ImportPortMovements ? l('SelectaPort') : l('SelectaCity')
                          }}</span>
                        </div>
                      </div>
                      <div class="col-lg-6" [hidden]="step1Dto.shippingTypeId == ShippingTypeEnum.LocalInsideCity">
                        <div class="form-group">
                          <label> {{ l('DestinationCity') }}<span class="required-fileds">*</span></label>
                          <div [ngClass]="{ 'spinner spinner-success spinner-right mr-1 ml-1': citiesLoading }">
                            <p-multiSelect
                              name="destinationCity"
                              [options]="destinationCities"
                              [(ngModel)]="step2Dto.shippingRequestDestinationCities"
                              optionLabel="cityName"
                              formControlName="destinationCity"
                              [class.is-valid]="
                                step2Form.get('destinationCity').valid &&
                                (step2Form.get('destinationCity').dirty || step2Form.get('destinationCity').touched)
                              "
                              [class.is-invalid]="
                                step2Form.get('destinationCity').invalid &&
                                (step2Form.get('destinationCity').dirty || step2Form.get('destinationCity').touched)
                              "
                              [disabled]="
                                (step1Dto.shippingTypeId == ShippingTypeEnum.LocalInsideCity || !step2Dto.originCityId ? true : false) ||
                                step2Dto.routeTypeId == null
                              "
                              [selectedItemsLabel]="'{0} items selected'"
                              (ngModelChange)="validateShippingRequestType()"
                              [style]="{ width: '100%' }"
                              styleClass="form-control pt-1"
                              [dataKey]="'cityId'"
                              [selectionLimit]="step2Dto.routeTypeId == 1 ? 1 : 10"
                            >
                            </p-multiSelect>
                            <div class="invalid-feedback">{{ l('SourceAndDestinationCantBeTheSame') }}</div>
                          </div>
                          <span class="form-text text-muted">{{ l('SelectaCity') }}</span>
                        </div>
                      </div>

                      <div
                        class="col-lg-6"
                        [hidden]="
                          step1Dto.shippingTypeId == ShippingTypeEnum.ImportPortMovements ||
                          step1Dto.shippingTypeId == ShippingTypeEnum.ExportPortMovements
                        "
                      >
                        <div class="form-group">
                          <label>{{ l('NumberOfDrops') }} <span class="required-fileds">*</span></label>
                          <input
                            class="form-control"
                            type="number"
                            name="numberOfDrops"
                            id="numberOfDrops"
                            formControlName="numberOfDrops"
                            maxlength="2"
                            [min]="step2Dto.routeTypeId == 1 ? 1 : 2"
                            [max]="100"
                            [(ngModel)]="step2Dto.numberOfDrops"
                            [class.is-invalid]="
                              step2Dto.routeTypeId == 3 && step2Form.get('numberOfDrops').touched && !step2Form.get('numberOfDrops').valid
                            "
                            [class.is-valid]="
                              step2Dto.routeTypeId == 3 && step2Form.get('numberOfDrops').touched && step2Form.get('numberOfDrops').valid
                            "
                            [attr.disabled]="step2Dto.routeTypeId != 3 ? true : null"
                            [required]="step2Dto.routeTypeId == 3"
                            (keypress)="numberOnly($event)"
                          />
                          <span class="form-text text-muted">{{ l('NumberOfDrops') }} </span>
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="form-group">
                          <label>{{ l('NumberOfTrips') }} <span class="required-fileds">*</span></label>
                          <input
                            class="form-control"
                            type="number"
                            name="numberOfTrips"
                            id="numberOfTrips"
                            formControlName="NumberOfTrips"
                            [(ngModel)]="step2Dto.numberOfTrips"
                            [min]="1"
                            (keypress)="numberOnly($event)"
                            [class.is-valid]="
                              step2Form.get('NumberOfTrips').valid && (step2Form.get('NumberOfTrips').dirty || step2Form.get('NumberOfTrips').touched)
                            "
                            [class.is-invalid]="
                              step2Form.get('NumberOfTrips').invalid &&
                              (step2Form.get('NumberOfTrips').dirty || step2Form.get('NumberOfTrips').touched)
                            "
                            required
                          />
                          <span class="form-text text-muted">{{ l('EnterNumberOfTrips') }}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--  end: Form Wizard Step 2-->

                  <!--begin: Form Wizard Step 3-->
                  <div class="pb-5" [formGroup]="step3Form" data-wizard-type="step-content">
                    <div class="row">
                      <div class="col-lg-6">
                        <label
                          >{{ l('MainGoodCategory') }}
                          <span
                            *ngIf="
                              step1Dto.shippingTypeId != ShippingTypeEnum.ImportPortMovements &&
                              step1Dto.shippingTypeId != ShippingTypeEnum.ExportPortMovements
                            "
                            class="required-fileds"
                            >*</span
                          ></label
                        >
                        <div [ngClass]="{ 'spinner spinner-success spinner-right mr-1 ml-1': !allGoodCategorys }">
                          <select
                            class="form-control"
                            name="goodCategory"
                            formControlName="goodCategory"
                            [disabled]="!allGoodCategorys"
                            [(ngModel)]="step3Dto.goodCategoryId"
                            [class.is-valid]="
                              step3Form.get('goodCategory').valid && (step3Form.get('goodCategory').dirty || step3Form.get('goodCategory').touched)
                            "
                            [class.is-invalid]="
                              step3Form.get('goodCategory').invalid && (step3Form.get('goodCategory').dirty || step3Form.get('goodCategory').touched)
                            "
                            [required]="
                              step1Dto.shippingTypeId != ShippingTypeEnum.ImportPortMovements &&
                              step1Dto.shippingTypeId != ShippingTypeEnum.ExportPortMovements
                            "
                          >
                            <!--                            <option [ngValue]="undefined" disabled selected>{{ l('SelectAGoodCategory') }}</option>-->
                            <option *ngFor="let item of allGoodCategorys" value="{{ item.id }}">{{ item.displayName }}</option>
                          </select>
                          <span class="form-text text-muted">{{ l('SelectaGoodCategory') }}</span>
                        </div>
                      </div>

                      <div class="col-lg-6">
                        <label>{{ l('TotalWeight') }} <span class="required-fileds">*</span></label>
                        <div>
                          <div class="input-group">
                            <div class="input-group-append">
                              <span class="input-group-text"> KG </span>
                            </div>
                            <input
                              type="number"
                              name="weight"
                              formControlName="weight"
                              class="form-control"
                              [min]="1"
                              [(ngModel)]="step3Dto.totalWeight"
                              [class.is-valid]="step3Form.get('weight').valid && (step3Form.get('weight').dirty || step3Form.get('weight').touched)"
                              [class.is-invalid]="
                                step3Form.get('weight').invalid && (step3Form.get('weight').dirty || step3Form.get('weight').touched)
                              "
                              required
                            />
                          </div>
                        </div>
                        <span class="form-text text-muted">{{ l('TotalWeightofGoodsinKG') }}</span>
                      </div>

                      <div class="col-lg-12 mt-4" [hidden]="!IfOther(allGoodCategorys, step3Dto.goodCategoryId)">
                        <label>{{ l('OtherGoodCategory') }} <span class="required-fileds">*</span></label>
                        <div>
                          <div class="input-group">
                            <input
                              type="text"
                              name="otherGoodsCategoryName"
                              formControlName="otherGoodsCategoryName"
                              class="form-control"
                              (change)="isOthersGoodCategoryId(step3Dto.goodCategoryId)"
                              [(ngModel)]="step3Dto.otherGoodsCategoryName"
                              [min]="1"
                              [class.is-valid]="
                                step3Form.get('otherGoodsCategoryName').valid &&
                                cannotContainSpace(step3Dto.otherGoodsCategoryName) &&
                                (step3Form.get('otherGoodsCategoryName').dirty || step3Form.get('otherGoodsCategoryName').touched)
                              "
                              [class.is-invalid]="
                                (step3Form.get('otherGoodsCategoryName').invalid || !cannotContainSpace(step3Dto.otherGoodsCategoryName)) &&
                                IfOther(allGoodCategorys, step3Dto.goodCategoryId) &&
                                (step3Form.get('otherGoodsCategoryName').dirty || step3Form.get('otherGoodsCategoryName').touched)
                              "
                              [required]="step3Form.get('goodCategory').valid && IfOther(allGoodCategorys, step3Dto.goodCategoryId)"
                            />
                          </div>
                        </div>
                        <span class="form-text text-muted">{{ l('otherGoodsCategoryName') }}</span>
                      </div>

                      <div class="col-lg-6 mt-4">
                        <div class="form-group">
                          <div
                            [ngClass]="{
                              'spinner spinner-success spinner-right mr-1 ml-1': !allpackingTypes
                            }"
                          >
                            <label>{{ l('PackingType') }} <span class="required-fileds">*</span></label>
                            <select
                              class="form-control"
                              name="packingType"
                              formControlName="packingType"
                              [(ngModel)]="step3Dto.packingTypeId"
                              [class.is-valid]="
                                step3Form.get('packingType').valid && (step3Form.get('packingType').dirty || step3Form.get('packingType').touched)
                              "
                              [class.is-invalid]="
                                step3Form.get('packingType').invalid && (step3Form.get('packingType').dirty || step3Form.get('packingType').touched)
                              "
                              [disabled]="!allpackingTypes"
                              required
                            >
                              <option [ngValue]="null" disabled selected>{{ l('SelectaPackingType') }}</option>
                              <option *ngFor="let item of allpackingTypes" value="{{ item.id }}">{{ item.displayName }}</option>
                            </select>
                          </div>
                          <span class="form-text text-muted">{{ l('EnterPackingType') }}</span>
                        </div>
                      </div>
                      <div class="col-lg-6 mt-4">
                        <div class="form-group">
                          <label>{{ l('NumberOfPacking') }} <span class="required-fileds">*</span></label>
                          <input
                            class="form-control"
                            type="number"
                            name="numberOfPacking"
                            id="numberOfPacking"
                            formControlName="numberOfPacking"
                            [(ngModel)]="step3Dto.numberOfPacking"
                            [min]="1"
                            [class.is-valid]="
                              step3Form.get('numberOfPacking').valid &&
                              (step3Form.get('numberOfPacking').dirty || step3Form.get('numberOfPacking').touched)
                            "
                            [class.is-invalid]="
                              step3Form.get('numberOfPacking').invalid &&
                              (step3Form.get('numberOfPacking').dirty || step3Form.get('numberOfPacking').touched)
                            "
                            required
                          />
                          <span class="form-text text-muted">{{ l('EnterNumberOfPacking') }}</span>
                        </div>
                      </div>
                      <div class="col-lg-12 mt-4" [hidden]="!IfOther(allpackingTypes, step3Dto.packingTypeId)">
                        <label>{{ l('OtherPackingType') }} <span class="required-fileds">*</span></label>
                        <div>
                          <div class="input-group">
                            <input
                              type="text"
                              name="otherPackingTypeName"
                              formControlName="otherPackingTypeName"
                              class="form-control"
                              [(ngModel)]="step3Dto.otherPackingTypeName"
                              [class.is-valid]="
                                step3Form.get('otherPackingTypeName').valid &&
                                cannotContainSpace(step3Dto.otherPackingTypeName) &&
                                (step3Form.get('otherPackingTypeName').dirty || step3Form.get('otherPackingTypeName').touched)
                              "
                              [class.is-invalid]="
                                (step3Form.get('otherPackingTypeName').invalid || !cannotContainSpace(step3Dto.otherPackingTypeName)) &&
                                IfOther(allpackingTypes, step3Dto.packingTypeId) &&
                                (step3Form.get('otherPackingTypeName').dirty || step3Form.get('otherPackingTypeName').touched)
                              "
                              [required]="step3Form.get('packingType').valid && IfOther(allpackingTypes, step3Dto.packingTypeId)"
                            />
                          </div>
                        </div>
                        <span class="form-text text-muted">{{ l('OtherPackingTypeName') }}</span>
                      </div>
                      <div class="col-lg-6 mt-4">
                        <label> {{ l('TransportType') }} <span class="required-fileds">*</span></label>
                        <div [ngClass]="{ 'spinner spinner-success spinner-right mr-1 ml-1': !allTransportTypes }">
                          <select
                            class="form-control"
                            name="transportType"
                            formControlName="transportType"
                            required
                            [attr.disabled]="allTransportTypes ? null : true"
                            [(ngModel)]="step3Dto.transportTypeId"
                            [class.is-valid]="
                              step3Form.get('transportType').valid && (step3Form.get('transportType').dirty || step3Form.get('transportType').touched)
                            "
                            [class.is-invalid]="
                              step3Form.get('transportType').invalid &&
                              (step3Form.get('transportType').dirty || step3Form.get('transportType').touched)
                            "
                            (change)="transportTypeSelectChange(step3Dto.transportTypeId)"
                          >
                            <option [ngValue]="null" disabled selected>{{ l('SelectaTransportType') }}</option>
                            <option *ngFor="let item of allTransportTypes" value="{{ item.id }}">{{ item.displayName }}</option>
                          </select>
                        </div>
                        <span class="form-text text-muted">{{ l('SelectaTransportType') }}</span>

                        <div class="mt-4 form-group" [hidden]="!IfOther(allTransportTypes, step3Dto.transportTypeId)">
                          <label>{{ l('OtherTransportType') }} <span class="required-fileds">*</span></label>
                          <div>
                            <div class="input-group">
                              <input
                                type="text"
                                name="otherTransportTypeName"
                                formControlName="otherTransportTypeName"
                                class="form-control"
                                [(ngModel)]="step3Dto.otherTransportTypeName"
                                [class.is-valid]="
                                  step3Form.get('otherTransportTypeName').valid &&
                                  cannotContainSpace(step3Dto.otherTransportTypeName) &&
                                  (step3Form.get('otherTransportTypeName').dirty || step3Form.get('otherTransportTypeName').touched)
                                "
                                [class.is-invalid]="
                                  (step3Form.get('otherTransportTypeName').invalid || !cannotContainSpace(step3Dto.otherTransportTypeName)) &&
                                  IfOther(allTransportTypes, step3Dto.transportTypeId) &&
                                  (step3Form.get('otherTransportTypeName').dirty || step3Form.get('otherTransportTypeName').touched)
                                "
                                [required]="step3Form.get('transportType').valid && IfOther(allTransportTypes, step3Dto.transportTypeId)"
                              />
                            </div>
                          </div>
                          <span class="form-text text-muted">{{ l('OtherTransportTypeName') }}</span>
                        </div>
                      </div>

                      <div class="col-lg-6 mt-4">
                        <label>{{ l('TruckType') }} <span class="required-fileds">*</span></label>
                        <div>
                          <div
                            [ngClass]="{
                              'spinner spinner-success spinner-right mr-1 ml-1': truckTypeLoading
                            }"
                          >
                            <select
                              class="form-control"
                              name="truckType"
                              formControlName="truckType"
                              [attr.disabled]="
                                step3Dto.transportTypeId == null
                                  ? true
                                  : null || allTransportTypes == null
                                  ? true
                                  : null || allTrucksTypes == null
                                  ? true
                                  : null
                              "
                              [(ngModel)]="step3Dto.trucksTypeId"
                              [class.is-valid]="
                                step3Form.get('truckType').valid && (step3Form.get('truckType').dirty || step3Form.get('truckType').touched)
                              "
                              [class.is-invalid]="
                                step3Form.get('truckType').invalid && (step3Form.get('truckType').dirty || step3Form.get('truckType').touched)
                              "
                              (change)="trucksTypeSelectChange(step3Dto.trucksTypeId)"
                              required
                            >
                              <option [ngValue]="null" selected disabled>{{ l('SelectaTruckType') }}</option>
                              <option *ngFor="let item of allTrucksTypes" value="{{ item.id }}">{{ item.displayName }}</option>
                            </select>
                          </div>
                        </div>

                        <span class="form-text text-muted">{{ l('SelectaTruckType') }}</span>

                        <div class="form-group" [hidden]="!IfOther(allTrucksTypes, step3Dto.trucksTypeId)">
                          <label>{{ l('OtherTruckType') }} <span class="required-fileds">*</span></label>
                          <div>
                            <div class="input-group">
                              <input
                                type="text"
                                name="otherTrucksTypeName"
                                formControlName="otherTrucksTypeName"
                                class="form-control"
                                [(ngModel)]="step3Dto.otherTrucksTypeName"
                                [class.is-valid]="
                                  step3Form.get('otherTrucksTypeName').valid &&
                                  cannotContainSpace(step3Dto.otherTrucksTypeName) &&
                                  (step3Form.get('otherTrucksTypeName').dirty || step3Form.get('otherTrucksTypeName').touched)
                                "
                                [class.is-invalid]="
                                  (step3Form.get('otherTrucksTypeName').invalid || !cannotContainSpace(step3Dto.otherTrucksTypeName)) &&
                                  IfOther(allTrucksTypes, step3Dto.trucksTypeId) &&
                                  (step3Form.get('otherTrucksTypeName').dirty || step3Form.get('otherTrucksTypeName').touched)
                                "
                                [required]="step3Form.get('truckType').valid && IfOther(allTrucksTypes, step3Dto.trucksTypeId)"
                              />
                            </div>
                          </div>
                          <span class="form-text text-muted">{{ l('otherTrucksTypeName') }}</span>
                        </div>
                      </div>

                      <div class="col-lg-12 mt-4">
                        <label>{{ l('Capacity') }} <span class="required-fileds">*</span></label>
                        <div
                          [ngClass]="{
                            'spinner spinner-success spinner-right mr-1 ml-1': capacityLoading
                          }"
                        >
                          <select
                            class="form-control"
                            name="capacity"
                            formControlName="capacity"
                            [attr.disabled]="
                              capacityLoading
                                ? true
                                : null || step3Dto.trucksTypeId == null
                                ? true
                                : null || step3Dto.transportTypeId == null
                                ? true
                                : null || allTransportTypes == null
                                ? true
                                : null || allTrucksTypes == null
                                ? true
                                : null
                            "
                            [(ngModel)]="step3Dto.capacityId"
                            [class.is-valid]="
                              step3Form.get('capacity').valid && (step3Form.get('capacity').dirty || step3Form.get('capacity').touched)
                            "
                            [class.is-invalid]="
                              step3Form.get('capacity').invalid && (step3Form.get('capacity').dirty || step3Form.get('capacity').touched)
                            "
                            required
                          >
                            <option [ngValue]="null" selected disabled>{{ l('SelectaCapacity') }}</option>
                            <option *ngFor="let item of allCapacities" value="{{ item.id }}">{{ item.displayName }}</option>
                          </select>
                        </div>
                        <span class="form-text text-muted">{{ l('SelectaCapacity') }}</span>
                      </div>
                    </div>
                  </div>
                  <!--end: Form Wizard Step 3-->

                  <!--begin: Form Wizard Step 4-->
                  <div class="pb-5" data-wizard-type="step-content">
                    <div class="mb-10 font-weight-bold text-dark"></div>
                    <div class="row">
                      <div class="col-sm-4">
                        <p-listbox
                          *ngIf="cleanedVases.length > 0"
                          [options]="cleanedVases"
                          [checkbox]="true"
                          filter="true"
                          multiple="true"
                          [(ngModel)]="selectedVases"
                          [listStyle]="{ 'text-align': 'center' }"
                          optionLabel="vasName"
                          [dataKey]="'vasId'"
                        ></p-listbox>
                      </div>
                      <div class="col-sm-8">
                        <table class="table" *ngIf="selectedVasesProperties.length > 0">
                          <thead>
                            <tr class="table-active">
                              <th scope="col">{{ l('VASType') }}</th>
                              <th scope="col">{{ l('Count') }}</th>
                              <th scope="col">{{ l('Amount') }}</th>
                              <th scope="col">{{ l('NumberOfTrips') }}</th>
                            </tr>
                          </thead>
                          <tbody>
                            <ng-container *ngFor="let item of selectedVases; index as i">
                              <tr *ngIf="selectedVasesProperties[item.vasId]">
                                <td>
                                  {{ selectedVasesProperties[item.vasId].vasName }}
                                </td>
                                <td>
                                  <input
                                    type="number"
                                    #VasCount="ngModel"
                                    [attr.disabled]="selectedVasesProperties[item.vasId].vasCountDisabled || null"
                                    id="VasCount{{ i }}"
                                    [(ngModel)]="item.requestMaxCount"
                                    (keypress)="numberOnly($event)"
                                    [required]="!selectedVasesProperties[item.vasId].vasCountDisabled"
                                    class="form-control"
                                    name="VasCount{{ i }}"
                                    min="0"
                                    [class.is-invalid]="VasCount.touched && !VasCount.disabled && item.requestMaxCount <= 0"
                                    [class.is-valid]="VasCount.touched && VasCount.valid && item.requestMaxCount > 0"
                                  />
                                </td>
                                <td>
                                  <input
                                    type="number"
                                    #VasAmount2="ngModel"
                                    [attr.disabled]="selectedVasesProperties[item.vasId].vasAmountDisabled || null"
                                    id="VasAmount2{{ i }}"
                                    [(ngModel)]="item.requestMaxAmount"
                                    (keypress)="numberOnly($event)"
                                    [required]="!selectedVasesProperties[item.vasId].vasAmountDisabled"
                                    class="form-control"
                                    name="VasAmount2{{ i }}"
                                    min="0"
                                    [class.is-invalid]="VasAmount2.touched && !VasAmount2.disabled && item.requestMaxAmount <= 0"
                                    [class.is-valid]="VasAmount2.touched && VasAmount2.valid && item.requestMaxAmount > 0"
                                  />
                                </td>
                                <td>
                                  <input
                                    #numberOfTrips="ngModel"
                                    type="number"
                                    id="numberOfTrips{{ i }}"
                                    [(ngModel)]="item.numberOfTrips"
                                    (keypress)="numberOnly($event)"
                                    class="form-control"
                                    name="numberOfTrips{{ i }}"
                                    required
                                    [class.is-invalid]="
                                      numberOfTrips.touched &&
                                      (!numberOfTrips.valid || item.numberOfTrips == 0 || step2Dto.numberOfTrips < item.numberOfTrips)
                                    "
                                    [class.is-valid]="numberOfTrips.touched && numberOfTrips.valid && step2Dto.numberOfTrips >= item.numberOfTrips"
                                    [max]="step2Dto.numberOfTrips"
                                    min="0"
                                  />
                                </td>
                              </tr>
                            </ng-container>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                  <!--end: Form Wizard Step 4-->
                  <!--begin: Form Wizard Step 5-->
                  <div class="pb-5" data-wizard-type="step-content">
                    <!--                    <h4 class="mb-10 font-weight-bold text-dark">{{ l('ReviewYourDetailsAndSubmit') }}</h4>-->

                    <div>
                      <div class="border-bottom mb-5 pb-5 map">
                        <agm-map [latitude]="24.717942" [longitude]="46.675761" [zoom]="10">
                          <agm-direction
                            *ngIf="destination.lat"
                            [origin]="{ lat: origin.lat, lng: origin.lng }"
                            [destination]="{ lat: destination.lat, lng: destination.lng }"
                            [travelMode]="'DRIVING'"
                          ></agm-direction>
                        </agm-map>
                      </div>

                      <div class="border-bottom mb-5 pb-5">
                        <div class="font-weight-bolder text-primary mb-3">{{ l('BasicDetails') }}:</div>
                        <div class="font-size-base line-height-xl">
                          {{ l('ShippingRequestType') }} : {{ requestType }}
                          <br />
                          {{ l('BiddingRange') }} : {{ shippingRequestReview?.shippingRequest?.bidStartDate | momentFormat: 'L' }} -
                          {{ shippingRequestReview?.shippingRequest?.bidEndDate | momentFormat: 'L' }}
                          <br />
                          {{ l('ShippingTypes') }} : {{ shippingRequestReview?.shippingTypeDisplayName }}
                          <br />
                          {{ l('TripsDateRange') }} : {{ shippingRequestReview?.shippingRequest?.startTripDate | momentFormat: 'L' }} -
                          {{ shippingRequestReview?.shippingRequest?.endTripDate | momentFormat: 'L' }}
                        </div>
                      </div>
                      <div class="border-bottom mb-5 pb-5">
                        <div class="font-weight-bolder text-primary mb-3">{{ l('RouteDetails') }}:</div>
                        <div class="line-height-xl">
                          {{ l('OriginCity') }} : {{ shippingRequestReview?.originalCityName }}
                          <br />
                          {{ l('DestinationCity') }} : {{ shippingRequestReview?.destinationCityName }}
                          <br />
                          <ng-container
                            *ngIf="
                              shippingRequestReview?.shippingRequest?.shippingTypeId != ShippingTypeEnum.ImportPortMovements &&
                              shippingRequestReview?.shippingRequest?.shippingTypeId != ShippingTypeEnum.ExportPortMovements
                            "
                          >
                            {{ l('RouteType') }} : {{ l(shippingRequestReview?.routTypeName) }}
                            <br />
                            {{ l('NumberOfDrops') }} : {{ shippingRequestReview?.shippingRequest?.numberOfDrops }}
                          </ng-container>
                          <ng-container
                            *ngIf="
                              shippingRequestReview?.shippingRequest?.shippingTypeId == ShippingTypeEnum.ImportPortMovements ||
                              shippingRequestReview?.shippingRequest?.shippingTypeId == ShippingTypeEnum.ExportPortMovements
                            "
                          >
                            <span *ngIf="shippingRequestReview?.routeTypeId === ShippingRequestRouteType.SingleDrop">
                              {{ l('RouteType') }} : {{ l(shippingRequestReview?.routTypeName) }}
                              <br />
                            </span>
                            {{ l('RoundTrip') }} : {{ l(shippingRequestReview?.roundTripTypeTitle) }}
                          </ng-container>
                          <br />
                          {{ l('NumberOfTrips') }} : {{ shippingRequestReview?.shippingRequest?.numberOfTrips }}
                        </div>
                      </div>
                      <div class="border-bottom mb-5 pb-5">
                        <div class="font-weight-bolder text-primary mb-3">{{ l('GoodDetails') }}:</div>
                        <div class="line-height-xl">
                          {{ l('MainGoodCategory') }} : {{ shippingRequestReview?.goodsCategoryName }}
                          <br />
                          {{ l('TotalWeight') }} : {{ shippingRequestReview?.shippingRequest?.totalWeight }}
                          <br />
                          {{ l('PackingType') }} : {{ shippingRequestReview?.packingTypeDisplayName }}
                          <br />
                          {{ l('NumberOfPacking') }} : {{ shippingRequestReview?.shippingRequest?.numberOfPacking }}
                          <br />
                          {{ l('TransportType') }} : {{ shippingRequestReview?.transportTypeDisplayName }}
                          <br />
                          {{ l('TruckType') }} : {{ shippingRequestReview?.truckTypeDisplayName }}
                          <br />
                          {{ l('Capacity') }} : {{ shippingRequestReview?.capacityDisplayName }}
                        </div>
                      </div>
                      <div class="mb-5 pb-5">
                        <div class="font-weight-bolder text-primary mb-3">{{ l('Vas') }}:</div>
                        <div class="line-height-xl">
                          <table class="table">
                            <thead>
                              <tr>
                                <th scope="col">#</th>
                                <th scope="col">{{ l('VasName') }}</th>
                                <th scope="col">{{ l('VasAmount') }}</th>
                                <th scope="col">{{ l('VasCount') }}</th>
                                <th scope="col">{{ l('NumberOfTrips') }}</th>
                              </tr>
                            </thead>
                            <tbody>
                              <ng-container *ngFor="let vas of selectedVases; let i = index">
                                <tr *ngIf="selectedVasesProperties[vas.vasId]">
                                  <th scope="row">{{ i + 1 }}</th>
                                  <th>{{ selectedVasesProperties[vas.vasId].vasName }}</th>
                                  <td>{{ vas.requestMaxAmount == 0 ? '-' : vas.requestMaxAmount }}</td>
                                  <td>{{ vas.requestMaxCount == 0 ? '-' : vas.requestMaxCount }}</td>
                                  <td>{{ vas.numberOfTrips == 0 ? '-' : vas.numberOfTrips }}</td>
                                </tr>
                              </ng-container>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--end: Form Wizard Step 5-->

                  <!--begin: Form Actions -->
                  <div class="d-flex justify-content-between border-top pt-10">
                    <div class="mr-2">
                      <div class="btn btn-light-dark font-weight text-uppercase px-9 py-4" data-wizard-type="action-prev">
                        {{ l('Previous') }}
                      </div>
                    </div>
                    <div>
                      <create-or-edit-template-drop-down-button
                        *ngIf="activeStep == 4 && (isShipper || isTachyonDealer || isCarrierSaas) && isEnabled('App.SaveTemplateFeature')"
                        [entityType]="entityType.ShippingRequestTemplate"
                        [sourceEntityId]="activeShippingRequestId"
                        [customClass]="'btn btn-outline-secondary font-weight-bold px-9 py-4 dropdown-toggle btn-elevate-hover mr-2'"
                      ></create-or-edit-template-drop-down-button>
                      <button (click)="onSubmit()" class="btn btn-primary font-weight-bold text-uppercase px-9 py-4" data-wizard-type="action-submit">
                        {{ l('Publish') }}
                      </button>
                      <button class="btn btn-primary font-weight-bold text-uppercase px-9 py-4" data-wizard-type="action-next" [buttonBusy]="saving">
                        {{ l('Next') }}
                      </button>
                    </div>
                  </div>
                  <!--end: Form Actions -->
                </div>
                <!--end: Form Wizard Form-->
              </div>
            </div>
          </div>
          <!--end: Wizard -->
        </div>
      </div>
    </div>
  </div>
</div>
