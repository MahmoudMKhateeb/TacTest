<div class="card card-custom gutter-b card-stretch" [@routerTransition]>
  <!--begin::Body-->
  <div class="card-body">
    <!--begin::Content-->
    <div class="d-flex flex-wrap">
      <!--      <input type="number" name="zoom" [(ngModel)]="zoom" />-->
      <!--      <ngx-skeleton-loader count="1" [animation]="'pulse'" [theme]="{ 'border-radius': '0', height: '300px' }"></ngx-skeleton-loader>-->
      <agm-map [zoom]="zoom" [longitude]="markerLong || 46.675761" [latitude]="markerLat || 24.717942">
        <agm-direction
          *ngIf="destination.lat && !markerLong"
          [origin]="{ lat: origin.lat, lng: origin.lng }"
          [destination]="{ lat: destination.lat, lng: destination.lng }"
          [travelMode]="'DRIVING'"
        ></agm-direction>
        <!--        <agm-marker *ngIf="markerLong" [longitude]="markerLong" [latitude]="markerLat">-->
        <!--          <agm-info-window>{{ markerFacilityName }}</agm-info-window>-->
        <!--        </agm-marker>-->
      </agm-map>
      <!--      <agm-map></agm-map>-->
    </div>

    <!--end::Content-->
    <!--begin::Text-->
    <p class="text-dark text-hover-primary font-weight-bold font-size-h4 mb-7 mt-3">{{ l('pointsDetails') }}</p>
    <!--end::Text-->
    <!--begin::Blog-->
    <div class="d-flex flex-column flex-grow-1">
      <!--begin::Head-->
      <div class="card card-custom gutter-b">
        <!--begin::Body-->
        <!--end::Body-->
      </div>
      <!--end::Head-->
      <!--begin::Row-->
      <div class="row d-flex justify-content-center">
        <div class="col-xl-11">
          <!--begin::Card-->
          <div class="card card-custom card-stretch" id="kt_todo_list">
            <!--begin::Body-->
            <div class="card-body p-0">
              <!--begin::Responsive container-->
              <div class="table-responsive">
                <!--begin::Items-->
                <div class="timeline timeline-3">
                  <ngx-skeleton-loader
                    count="2"
                    *ngIf="!routePoints"
                    [animation]="'pulse'"
                    [theme]="{ 'border-radius': '0', height: '100px' }"
                  ></ngx-skeleton-loader>

                  <div class="timeline-items">
                    <div *ngFor="let point of routePoints; let i = index" class="timeline-item ribbon ribbon-top">
                      <div *ngIf="point.isComplete" class="ribbon-target bg-success" style="top: -2px; right: 20px">{{ l('Completed')}}</div>
                      <div class="timeline-media pulse pulse-{{ point.pickingType == 1 ? 'primary' : 'danger' }}">
                        <i
                          class="flaticon2-{{ point.pickingType == 1 ? 'up' : 'down' }}  {{
                                                point.pickingType == 1 ? 'text-success' : 'text-danger'
                                              }}"
                        ></i>
                        <span class="pulse-ring"></span>
                      </div>
                      <div class="timeline-content" [ngClass]="{ active: item === point.id }" (click)="timeLinePanelClick(point)">
                        <div class="d-flex align-items-center justify-content-between">
                          <div class="mr-2">
                            <a href="#" class="text-dark-75 text-hover-primary font-weight-bold">
                              {{ point.pickingType == 1 ? 'Pickup location' : 'Drop Of Location' }} .</a
                            >
                          </div>
                        </div>
                        <div class="d-flex justify-content-end">
                          <!--                          <div class="mt-2">-->
                          <!--                            <p>{{ point.address }}</p>-->
                          <!--                          </div>-->
                          <!--                 point info           -->
                          <!--                          <div class="row d-flex justify-content-between flex-nowrap mb-6">-->
                          <!--                            &lt;!&ndash;begin::Info&ndash;&gt;-->
                          <!--                            <div class="col-6 col-md-4">-->
                          <!--                              <div class="mb-8 d-flex flex-column">-->
                          <!--                                <span class="text-dark font-weight-bold mb-4">Brand</span>-->
                          <!--                                <span class="text-muted font-weight-bolder font-size-lg">Nike Horizon</span>-->
                          <!--                              </div>-->
                          <!--                            </div>-->
                          <!--                            <div class="col-6 col-md-4">-->
                          <!--                              <div class="mb-8 d-flex flex-column">-->
                          <!--                                <span class="text-dark font-weight-bold mb-4">SKU</span>-->
                          <!--                                <span class="text-muted font-weight-bolder font-size-lg">NF3535345</span>-->
                          <!--                              </div>-->
                          <!--                            </div>-->
                          <!--                            <div class="col-6 col-md-4">-->
                          <!--                              <div class="mb-8 d-flex flex-column">-->
                          <!--                                <span class="text-dark font-weight-bold mb-4">Color</span>-->
                          <!--                                <span class="text-muted font-weight-bolder font-size-lg">Pure White</span>-->
                          <!--                              </div>-->
                          <!--                            </div>-->

                          <!--                            &lt;!&ndash;end::Info&ndash;&gt;-->
                          <!--                          </div>-->
                          <div class="btn-group">
                            <!--    trip actions-->
                            <div
                              class="d-inline-block mt-8"
                              ngbDropdown
                              *ngIf="point.pickingType == pickingTypeEnum.Pickup &&  trip.status === tripStatusesEnum.New  "
                            >
                              <button class="btn btn-sm btn-success" ngbDropdownToggle [buttonBusy]="saving">{{l('Actions')}}</button>

                              <div ngbDropdownMenu aria-labelledby="dropdownManual" dropdownConfig>
                                <button ngbDropdownItem (click)="accept()" *ngIf="trip.driverStatus === driverStatusesEnum.None">
                                  {{ l('AcceptTrip') }}
                                </button>
                                <button
                                  ngbDropdownItem
                                  (click)="start()"
                                  *ngIf="trip.canStartTrip && trip.status === tripStatusesEnum.New && trip.driverStatus === driverStatusesEnum.Accepted"
                                >
                                  {{ l('StartTrip') }}
                                </button>
                              </div>
                            </div>
                            <!--                      points DropDown Actions      -->
                            <div class="d-inline-block mt-8" ngbDropdown *ngIf=" !point.isComplete && trip.status !== tripStatusesEnum.New">
                              <button
                                class="btn btn-sm btn-success"
                                id="dropdownConfig"
                                ngbDropdownToggle
                                [buttonBusy]="saving"
                                [disabled]="!canStartAnotherPoint  && !point.isActive "
                              >
                                <!--     || (point.pickingType == 2 && !point.isActive || point.availableTransactions.length === 0)-->
                                {{l('Actions')}}
                              </button>
                              <div ngbDropdownMenu aria-labelledby="dropdownManual" dropdownConfig>
                                <button
                                  ngbDropdownItem
                                  (click)="nextLocation(point)"
                                  *ngIf="!point.isActive && !point.isComplete && canStartAnotherPoint"
                                >
                                  {{ l('StartDropPoint') }}
                                </button>
                                <button
                                  ngbDropdownItem
                                  *ngFor="let transaction of point.availableTransactions; let x = index"
                                  (click)="invokeStatus(point , transaction)"
                                >
                                  {{ transaction.name }}
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="d-flex flex-column justify-content-between mt-4">
                          <p-steps
                            [model]="getStepperSteps(point.statues)"
                            [(activeIndex)]="activeIndex"
                            [readonly]="true"
                            [busyIf]="pointsIsLoading"
                          ></p-steps>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--end::Items-->
              </div>
              <!--end::Responsive container-->
            </div>
            <!--end::Body-->
          </div>
          <!--end::Card-->
        </div>
      </div>
      <!--end::Row-->
    </div>
    <!--end::Blog-->
  </div>
  <!--end::Body-->
</div>
<tacking-confirm-code-model #modelconfirm (modalConfirm)="getForView()"></tacking-confirm-code-model>
<complete-tracking-point-details #completeTrackingPointDetails></complete-tracking-point-details>
<tacking-pod-model #modelpod (modalConfirm)="getForView()"></tacking-pod-model>
<upload-delivery-note-document-model #modelDeliveryNote></upload-delivery-note-document-model>
