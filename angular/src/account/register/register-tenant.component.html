<div class="login-form" [@routerTransition]>
  <div class="text-left login-logo">
    <a>
      <img [src]="appRootUrl() + 'assets/common/images/app-logo-on-light-login.svg'" class="max-h-75px" (click)="goToHome()" />
    </a>
  </div>
  <div class="text-left label-text">
    <h3 class="font-weight-bolder text-dark font-size-h4 font-size-h1-lg">
      {{ 'SignUp' | localize }}
    </h3>
  </div>
  <h4 *ngIf="model.edition" class="text-left">{{ 'IAMA' | localize }}: {{ model.edition.displayName }}</h4>
  <div class="separator separator-border-dashed"></div>
  <hr />

  <form #registerForm="ngForm" role="form" novalidate (submit)="save()" class="login-form form mt-2">
    <h5 style="text-align: center;">
      {{ 'CompanyInformation' | localize }}
      <br />
      <br />
    </h5>
    <!-- <hr /> -->
    <div class="row">
      <div class="col-6">
        <div class="form-group">
          <input
            #tenancyName="ngModel"
            class="form-control py-7 font-size-h6"
            autoFocus
            type="text"
            placeholder="{{ 'CompanyUniqueName' | localize }} *"
            (change)="checkIfIsCompanyUniqueName()"
            [(ngModel)]="model.tenancyName"
            name="tenancyName"
            required
            style="width: 100% !important;"
            maxlength="64"
            pattern="^[a-zA-Z][a-zA-Z0-9_-]{1,}$"
          />
          <div>
            <validation-messages [formCtrl]="tenancyName"></validation-messages>
            <span class="form-text text-muted">{{ l('Enter') }} {{ l('CompanyUniqueName') }}</span>
            <span *ngIf="!isCompanyNameAvailable" class="form-text text-danger text-left"
              >{{ 'CompanyUniqueName' | localize }} {{ 'AlreadyTaken' | localize }}</span
            >
            <span *ngIf="!tenancyName.valid && !tenancyName.pristine" class="form-text text-danger text-left">{{
              'CompanyUniqueName_Regex_Description' | localize
            }}</span>
          </div>
        </div>
      </div>

      <div class="col-6">
        <div class="form-group">
          <input
            #nameInput="ngModel"
            class="form-control py-7 font-size-h6"
            type="text"
            placeholder="{{ 'CompanyFullLeagalName' | localize }} *"
            [(ngModel)]="model.name"
            name="Name"
            required
            maxlength="128"
          />
          <div>
            <span class="form-text text-muted">{{ l('Enter') }} {{ l('CompanyFullLegalName') }}</span>
          </div>
          <validation-messages [formCtrl]="nameInput"></validation-messages>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-6">
        <div class="form-group">
          <select
            (change)="CountryChanged($event)"
            #countrySelect="ngModel"
            class="form-control form-control-lg custom-select mr-sm-2"
            name="tenant.countryId"
            [(ngModel)]="model.countryId"
            required
          >
            <option selected value="-2">{{ l('Select') }} {{ l('Country') }}</option>
            <option *ngFor="let country of allCountries" value="{{ country.id }}">{{ country.displayName }}</option>
          </select>
          <div>
            <span class="form-text text-muted">{{ l('Select') }} {{ l('Country') }}</span>
            <span class="form-text text-danger" *ngIf="countrySelect.value == -2 && countrySelect.touched"
              >{{ l('Country') }} {{ l('isRequired') }}</span
            >
          </div>
          <!-- <validation-messages [formCtrl]="nameInput"></validation-messages> -->
        </div>
      </div>

      <div class="col-6">
        <div class="form-group">
          <select
            [disabled]="!isCountySelected"
            #citySelect="ngModel"
            class="form-control form-control-lg custom-select mr-sm-2"
            name="tenant.cityId"
            [(ngModel)]="model.cityId"
            required
          >
            <option value="-2">{{ l('Select') }} {{ l('City') }}</option>
            <option *ngFor="let city of allCities" value="{{ city.id }}">{{ city.displayName }}</option>
          </select>
          <div>
            <span class="form-text text-muted">{{ l('Select') }} {{ l('City') }}</span>
            <span class="form-text text-danger" *ngIf="citySelect.value == -2 && citySelect.touched">{{ l('City') }} {{ l('isRequired') }}</span>
          </div>
          <!-- <validation-messages [formCtrl]="cityInput"></validation-messages> -->
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-12">
        <div class="form-group">
          <input
            #addressInput="ngModel"
            class="form-control py-7 font-size-h6"
            type="Address"
            placeholder="{{ 'AddressFormat' | localize }} *"
            [(ngModel)]="model.address"
            name="Address"
            required
            maxlength="128"
          />
          <div>
            <validation-messages [formCtrl]="addressInput"></validation-messages>
            <span class="form-text text-muted"> {{ l('Enter') }} {{ l('Address') }}</span>
            <span class="form-text text-muted"> {{ l('Format') }} :{{ l('AddressFormat') }}</span>
          </div>
        </div>
      </div>
    </div>

    <h5 style="text-align: center;" class="mt-2">
      {{ 'AdminUserAccountInfo' | localize }}
    </h5>
    <br />
    <div class="row">
      <div class="col-12">
        <div class="form-group">
          <input
            #adminEmailAddressInput="ngModel"
            class="form-control py-7 font-size-h6"
            type="email"
            placeholder="{{ 'AdminEmailAddress' | localize }} *"
            [(ngModel)]="model.adminEmailAddress"
            name="adminEmailAddress"
            required
            (change)="removeWhiteSpacesFromEmail()"
            maxlength="256"
            email
          />
          <div>
            <span class="form-text text-muted"> {{ l('Enter') }} {{ l('AdminEmailAddress') }}</span>
            <span *ngIf="!isEmailValid" class="form-text text-danger">{{ l('AdminEmailAddress') }} {{ l('NotValid') }}</span>
            <span *ngIf="!isEmailAvailable" class="form-text text-danger">{{ l('AdminEmailAddress') }} {{ 'AlreadyTaken' | localize }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-6">
        <div class="form-group">
          <input
            type="password"
            name="Password"
            class="form-control py-7 font-size-h6"
            [(ngModel)]="model.adminPassword"
            #Password="ngModel"
            placeholder="{{ 'AdminPassword' | localize }}"
            validateEqual="PasswordRepeat"
            reverse="true"
            [requireDigit]="passwordComplexitySetting.requireDigit"
            [requireLowercase]="passwordComplexitySetting.requireLowercase"
            [requireUppercase]="passwordComplexitySetting.requireUppercase"
            [requireNonAlphanumeric]="passwordComplexitySetting.requireNonAlphanumeric"
            [requiredLength]="passwordComplexitySetting.requiredLength"
            required
            pPassword
            [promptLabel]="l('PleaseEnterYourNewPassword')"
            [weakLabel]="l('weak')"
            [mediumLabel]="l('medium')"
            [strongLabel]="l('strong')"
          />
          <div [hidden]="registerForm.form.valid || registerForm.form.pristine" class="form-group">
            <ul class="form-text text-danger" *ngIf="Password.errors">
              <li [hidden]="!Password.errors.requireDigit">{{ 'PasswordComplexity_RequireDigit_Hint' | localize }}</li>
              <li [hidden]="!Password.errors.requireLowercase">
                {{ 'PasswordComplexity_RequireLowercase_Hint' | localize }}
              </li>
              <li [hidden]="!Password.errors.requireUppercase">
                {{ 'PasswordComplexity_RequireUppercase_Hint' | localize }}
              </li>
              <li [hidden]="!Password.errors.requireNonAlphanumeric">
                {{ 'PasswordComplexity_RequireNonAlphanumeric_Hint' | localize }}
              </li>
              <li [hidden]="!Password.errors.requiredLength">
                {{ 'PasswordComplexity_RequiredLength_Hint' | localize: passwordComplexitySetting.requiredLength }}
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="col-6">
        <div class="form-group">
          <input
            type="password"
            name="PasswordRepeat"
            class="form-control py-7 font-size-h6"
            [ngModel]="model.passwordRepeat"
            #PasswordRepeat="ngModel"
            placeholder="{{ 'PasswordRepeat' | localize }}"
            validateEqual="Password"
            reverse="false"
            [requireDigit]="passwordComplexitySetting.requireDigit"
            [requireLowercase]="passwordComplexitySetting.requireLowercase"
            [requireUppercase]="passwordComplexitySetting.requireUppercase"
            [requireNonAlphanumeric]="passwordComplexitySetting.requireNonAlphanumeric"
            [requiredLength]="passwordComplexitySetting.requiredLength"
            required
          />
          <div [hidden]="registerForm.form.valid || registerForm.form.pristine" class="form-group">
            <ul class="form-text text-danger" *ngIf="PasswordRepeat.errors">
              <li [hidden]="!PasswordRepeat.errors.requireDigit">
                {{ 'PasswordComplexity_RequireDigit_Hint' | localize }}
              </li>
              <li [hidden]="!PasswordRepeat.errors.requireLowercase">
                {{ 'PasswordComplexity_RequireLowercase_Hint' | localize }}
              </li>
              <li [hidden]="!PasswordRepeat.errors.requireUppercase">
                {{ 'PasswordComplexity_RequireUppercase_Hint' | localize }}
              </li>
              <li [hidden]="!PasswordRepeat.errors.requireNonAlphanumeric">
                {{ 'PasswordComplexity_RequireNonAlphanumeric_Hint' | localize }}
              </li>
              <li [hidden]="!PasswordRepeat.errors.requiredLength">
                {{ 'PasswordComplexity_RequiredLength_Hint' | localize: passwordComplexitySetting.requiredLength }}
              </li>
              <li [hidden]="!PasswordRepeat.touched && !PasswordRepeat.valid">{{ 'PasswordsDontMatch' | localize }}</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <button
      style="margin-top: 0px !important; height: 35px;"
      [disabled]="saving"
      routerLink="/account/login"
      type="button"
      class="btn btn-primary btn-primary-login"
    >
      <i class="fa fa-arrow-left"></i> {{ 'Back' | localize }}
    </button>
    <button
      style="margin-top: 0px !important; height: 35px;"
      type="submit"
      class="btn btn-primary btn-primary-login"
      [disabled]="
        !isEmailValid ||
        !isEmailAvailable ||
        !isCompanyNameAvailable ||
        !registerForm.form.valid ||
        citySelect.value == -2 ||
        countrySelect.value == -2
      "
      [buttonBusy]="saving"
      [busyText]="l('SavingWithThreeDot')"
    >
      <i class="fa fa-check"></i> {{ 'Submit' | localize }}
    </button>
  </form>
</div>
